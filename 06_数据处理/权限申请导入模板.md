# Excel数据导入模板说明

## Excel模板格式

### 必需列（按顺序）
| 列序号 | 列名 | 数据类型 | 是否必填 | 示例值 | 说明 |
|--------|------|----------|----------|--------|------|
| A | 申请人姓名 | 文本 | 是 | 张三 | 权限申请人的真实姓名 |
| B | 申请人邮箱 | 文本 | 是 | zhangsan@company.com | 用于接收审批结果通知 |
| C | 权限系统 | 文本 | 是 | ERP系统 | 需要申请权限的目标系统 |
| D | 权限对象 | 文本 | 是 | 财务模块查询权限 | 具体的权限内容描述 |
| E | 申请原因 | 文本 | 否 | 工作需要查看财务报表 | 申请权限的业务理由 |
| F | 预计使用期限 | 文本 | 否 | 3个月 | 权限有效期预期 |

### 数据验证规则

#### 申请人邮箱格式
- 必须符合标准邮箱格式：xxx@domain.com
- 不能包含中文字符
- 长度不超过100字符

#### 权限系统
- 预定义选项：ERP系统、CRM系统、OA系统、财务系统、HR系统、其他
- 如选择"其他"，需在权限对象中详细说明

#### 数据长度限制
- 申请人姓名：不超过50字符
- 权限对象：不超过200字符
- 申请原因：不超过500字符
- 预计使用期限：不超过50字符

### 示例数据

```
申请人姓名    申请人邮箱               权限系统    权限对象           申请原因           预计使用期限
张三         zhangsan@company.com     ERP系统     财务模块查询权限    工作需要查看财务报表  3个月
李四         lisi@company.com         CRM系统     客户信息管理权限    负责客户关系维护     6个月
王五         wangwu@company.com       OA系统      请假审批权限       担任部门主管        长期
```

### 注意事项

1. **首行必须是标题行**，系统会自动跳过第一行
2. **不要在数据中使用换行符**，会导致解析错误
3. **邮箱地址必须唯一**，重复邮箱会被合并处理
4. **空行会被自动忽略**
5. **建议单次导入不超过1000条记录**

### 常见错误处理

#### 格式错误
- 文件不是Excel格式 → 请使用.xlsx或.xls文件
- 缺少必填字段 → 检查A-D列是否完整填写
- 邮箱格式错误 → 确保邮箱格式正确

#### 数据错误
- 重复申请检查 → 系统会提示相同申请人+权限系统的重复记录
- 字符长度超限 → 根据提示缩短对应字段内容
- 特殊字符处理 → 避免使用特殊符号，如：|、&、<、>

### 导入流程

1. 下载Excel模板文件
2. 按照格式要求填写数据
3. 保存为.xlsx格式
4. 在Power Apps中选择文件上传
5. 系统自动验证数据格式
6. 预览导入数据
7. 确认导入并开始处理

### 导入后处理

- 系统自动生成申请编号
- 根据权限系统匹配对应审核人
- 发送确认邮件给申请人
- 更新申请状态为"待审批"