# 审核人管理界面设计

## 页面架构概览

### 页面布局结构
- 顶部：页面标题和操作按钮区域
- 左侧：审核人列表和筛选器
- 右侧：审核人详情编辑面板
- 底部：批量操作和分页控件

## 1. 页面标题区域

### 标题和导航
```
控件类型: Container (水平布局)
属性配置:
- Height: 80
- Fill: RGBA(248, 248, 248, 1)
- Padding: 20

包含控件:
- TitleLabel: "审核人管理"
- BreadcrumbNav: "首页 > 系统配置 > 审核人管理"
- HelpButton: "帮助文档"
```

### 快速操作按钮组
```
控件类型: Container (水平布局)
属性配置:
- Direction: Horizontal
- Gap: 15
- Align: Right

包含控件:
- AddReviewerButton: "添加审核人"
- ImportButton: "批量导入"
- ExportButton: "导出配置"
- SettingsButton: "设置"
```

## 2. 筛选和搜索区域

### 搜索控件
```
控件类型: Text Input
属性配置:
- PlaceholderText: "搜索审核人姓名或邮箱..."
- OnChange: Set(varSearchText, Self.Text); Set(varFilteredReviewers, Filter(ReviewerConfig, SearchColumns(ReviewerName & " " & ReviewerEmail, varSearchText)))
- Width: 300
- Height: 40
- Icon: Icon.Search
```

### 筛选器组
```
控件类型: Container (水平布局)
属性配置:
- Gap: 15
- Wrap: true

包含控件:
- SystemScopeFilter: 
  - 控件类型: Dropdown
  - Items: ["全部系统", "ERP系统", "CRM系统", "OA系统", "财务系统", "HR系统", "其他"]
  - DefaultSelectedItems: ["全部系统"]
  
- StatusFilter:
  - 控件类型: Dropdown  
  - Items: [
      {Value: "All", Label: "全部状态"},
      {Value: true, Label: "启用"},
      {Value: false, Label: "禁用"}
    ]
  - DefaultSelectedItems: [{Value: "All", Label: "全部状态"}]
  
- ClearFiltersButton: "清除筛选"
```

## 3. 审核人列表区域

### 数据表格 (Gallery)
```
控件类型: Gallery (垂直布局)
属性配置:
- Items: varFilteredReviewers
- TemplateSize: 80
- Width: 600
- Height: Parent.Height - 200

数据源: ReviewerConfig SharePoint列表
筛选逻辑: 
  Filter(ReviewerConfig,
    (varSearchText = "" || 
     SearchColumns(ReviewerName & " " & ReviewerEmail, varSearchText)) &&
    (SystemScopeFilter.Selected.Value = "全部系统" || 
     SystemScopeFilter.Selected.Value in SystemScope) &&
    (StatusFilter.Selected.Value = "All" || 
     IsActive = StatusFilter.Selected.Value)
  )
```

### 表格行模板设计
```
控件布局 (每行):
- 左侧头像区域 (60x60):
  - PersonaImage: 显示审核人头像
  - StatusIndicator: 启用/禁用状态指示器

- 中间信息区域:
  - ReviewerNameLabel: 审核人姓名
    - Font: Open Sans Semibold, Size: 16
    - Color: RGBA(32, 31, 30, 1)
  
  - ReviewerEmailLabel: 邮箱地址
    - Font: Open Sans, Size: 12
    - Color: RGBA(96, 94, 92, 1)
  
  - SystemScopeChips: 负责系统范围标签
    - 控件类型: Container (水平布局)
    - 每个系统显示为小标签

- 右侧操作区域:
  - EditButton: 编辑按钮
  - DeleteButton: 删除按钮
  - MoreActionsButton: 更多操作下拉菜单
```

### 状态指示器样式
```
启用状态:
- Icon: Icon.CheckMark
- Color: RGBA(16, 124, 16, 1)
- Fill: RGBA(223, 246, 221, 1)

禁用状态:
- Icon: Icon.Cancel
- Color: RGBA(164, 38, 44, 1) 
- Fill: RGBA(253, 231, 233, 1)
```

## 4. 审核人详情编辑面板

### 面板结构
```
控件类型: Container (垂直布局)
属性配置:
- Width: Parent.Width - 650
- Height: Parent.Height - 120
- Visible: !IsBlank(varSelectedReviewer)
- Fill: RGBA(255, 255, 255, 1)
- BorderColor: RGBA(225, 223, 221, 1)
- BorderThickness: 1
```

### 基本信息编辑区
```
表单控件组:

1. ReviewerNameInput:
   - 控件类型: Text Input
   - Label: "审核人姓名 *"
   - Required: true
   - MaxLength: 50

2. ReviewerEmailInput:
   - 控件类型: Text Input
   - Label: "审核人邮箱 *"
   - Format: Email
   - Required: true
   - MaxLength: 100

3. DepartmentInput:
   - 控件类型: Text Input
   - Label: "所属部门"
   - MaxLength: 100

4. JobTitleInput:
   - 控件类型: Text Input
   - Label: "职务"
   - MaxLength: 50

5. PhoneInput:
   - 控件类型: Text Input
   - Label: "联系电话"
   - Format: Phone
```

### 权限系统配置区
```
SystemScopeContainer:
- 控件类型: Container
- Label: "负责系统范围 *"

包含控件:
- SystemScopeCheckboxGroup:
  - 控件类型: Checkbox Group
  - Items: [
      {Value: "ERP系统", Label: "ERP系统"},
      {Value: "CRM系统", Label: "CRM系统"},
      {Value: "OA系统", Label: "OA系统"},
      {Value: "财务系统", Label: "财务系统"},
      {Value: "HR系统", Label: "HR系统"},
      {Value: "其他", Label: "其他"}
    ]
  - Layout: 纵向排列，每行2个选项

- CustomSystemInput:
  - 控件类型: Text Input  
  - Visible: "其他" in SystemScopeCheckboxGroup.SelectedItems
  - Label: "请指定其他系统"
```

### 高级配置区
```
AdvancedSettingsContainer:

1. PrioritySlider:
   - 控件类型: Slider
   - Label: "优先级 (1-10)"
   - Min: 1, Max: 10, Default: 5
   - Description: "优先级越高，越优先分配申请"

2. AutoAssignSwitch:
   - 控件类型: Toggle
   - Label: "自动分配"
   - Description: "是否自动接收相关系统的权限申请"

3. NotificationSettingsGroup:
   - EmailNotifySwitch: "邮件通知"
   - SMSNotifySwitch: "短信通知"  
   - TeamsNotifySwitch: "Teams通知"

4. WorkingHoursSettings:
   - WorkingDaysCheckbox: 工作日选择
   - WorkingHoursStart: 工作开始时间
   - WorkingHoursEnd: 工作结束时间
```

### 审批统计信息区
```
StatisticsContainer:
- 控件类型: Container
- 显示内容:
  - 总审批数量
  - 本月审批数量
  - 平均审批时间
  - 超时审批次数

实现方式:
- 从ApprovalHistory表查询相关统计数据
- 使用图表控件显示趋势
```

## 5. 操作按钮区域

### 编辑模式按钮组
```
EditModeButtons:
- SaveButton: "保存"
  - OnSelect: 执行保存逻辑
  - Fill: RGBA(0, 120, 212, 1)
  - Color: White
  
- CancelButton: "取消" 
  - OnSelect: 重置表单并退出编辑模式
  - Fill: RGBA(243, 242, 241, 1)
  - Color: RGBA(32, 31, 30, 1)

- DeleteButton: "删除"
  - OnSelect: 显示确认对话框
  - Fill: RGBA(196, 49, 75, 1)
  - Color: White
  - Visible: !IsBlank(varSelectedReviewer)
```

### 批量操作区域
```
BulkOperationContainer:
- 位置: 页面底部
- 高度: 60px

包含控件:
- SelectAllCheckbox: "全选"
- BulkEnableButton: "批量启用"
- BulkDisableButton: "批量禁用" 
- BulkDeleteButton: "批量删除"
- SelectedCountLabel: "已选择 {count} 项"
```

## 6. 对话框和确认窗口

### 删除确认对话框
```
DeleteConfirmDialog:
- 控件类型: Container (覆盖层)
- 标题: "确认删除审核人"
- 内容: "确定要删除审核人 {ReviewerName} 吗？此操作不可撤销。"
- 按钮: "确认删除" | "取消"
- 警告: 检查是否有未完成的审批任务
```

### 添加审核人对话框
```
AddReviewerDialog:
- 控件类型: Modal Dialog
- 大小: 500x600
- 内容: 与编辑面板相同的表单控件
- 验证规则: 
  - 邮箱唯一性检查
  - 必填字段验证
  - 邮箱格式验证
```

## 7. 数据验证逻辑

### 客户端验证
```
表单验证规则:
- ReviewerNameInput: 
  - Required: true
  - Pattern: 中英文姓名格式
  
- ReviewerEmailInput:
  - Required: true  
  - Unique: 在现有记录中唯一
  - Format: 标准邮箱格式
  
- SystemScope:
  - Required: 至少选择一个系统
  - Custom: 选择"其他"时必须填写说明

验证触发时机:
- OnChange: 实时验证
- OnSave: 完整性验证
- OnSubmit: 服务器端验证
```

### 服务器端验证
```
Power Automate验证流程:
1. 邮箱唯一性检查
2. AD域用户存在性验证
3. 系统权限合法性检查
4. 数据完整性验证
```

## 8. 界面状态管理

### 页面变量
```
全局变量:
- varSelectedReviewer: 当前选中的审核人
- varFilteredReviewers: 筛选后的审核人列表
- varSearchText: 搜索关键词
- varEditMode: 编辑模式状态
- varSelectedItems: 批量选择的项目
- varShowDeleteDialog: 删除确认对话框显示状态
- varFormErrors: 表单验证错误信息

状态变量:
- varLoading: 数据加载状态
- varSaving: 保存操作状态
- varDeleting: 删除操作状态
```

### 响应式设计
```
屏幕适配:
- 大屏幕 (>1200px): 左右分栏布局
- 中等屏幕 (768-1200px): 上下布局
- 小屏幕 (<768px): 单列堆叠布局

控件自适应:
- 使用Parent.Width进行宽度计算
- 使用条件格式根据屏幕大小调整布局
- 移动端优化：增大触摸目标，简化操作流程
```

## 9. 用户体验优化

### 交互反馈
```
加载状态:
- 数据加载时显示加载动画
- 保存时按钮显示保存中状态
- 删除时显示确认进度

操作提示:
- 成功操作：绿色通知横幅
- 错误操作：红色错误提示
- 警告信息：黄色警告提示

键盘快捷键:
- Ctrl+S: 保存当前编辑
- Esc: 取消当前操作
- Ctrl+F: 聚焦搜索框
```

### 数据缓存和性能
```
性能优化:
- 使用Collection进行客户端数据缓存
- 分页加载大量数据
- 延迟加载审核人详情信息
- 搜索防抖处理，避免频繁查询
```